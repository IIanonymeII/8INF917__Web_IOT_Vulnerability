# urlize.py
import re
from django import template
from django.utils.html import escape
from django.utils.safestring import mark_safe

register = template.Library()

@register.filter
def urlize(value):
	print(value)
	url_pattern = re.compile(r'http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+')
	urls = url_pattern.findall(value)
	for url in urls:
		print(url)
		value = value.replace(url, '<a href="{}" target="_blank">{}</a>'.format(escape(url), escape(url)))
	return mark_safe(value)