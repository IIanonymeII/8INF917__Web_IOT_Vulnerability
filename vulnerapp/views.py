from django.shortcuts import render
import requests
from django.http import JsonResponse
from django.conf import settings
from database.models import CVE
from database.functions import update_database


def fetch_api(request):
    return update_database()

def home_page(request):
    vulnerabilities = CVE.objects.all().order_by('-last_updated')[:5]
    return render(request, 'home.html', {'vulnerabilities': vulnerabilities})

def all_page(request):
    vulnerabilities = CVE.objects.all().order_by('-last_updated')
    return render(request, 'all.html', {'vulnerabilities': vulnerabilities})

def details_page(request, cve_id):
	cve = CVE.objects.get(id=cve_id)
	return render(request, 'details.html', {'cve': cve})