from django.db import models
from django.utils import timezone

class CVE(models.Model):
    id = models.CharField(max_length=50, primary_key=True)
    description = models.TextField(default="")
    title = models.CharField(max_length=200, default="", blank=True)
    type = models.CharField(max_length=50, default="", blank=True)
    last_updated = models.DateTimeField(default=timezone.now)
    release_date = models.DateTimeField(default=timezone.now)
    severity = models.CharField(max_length=50, default="", blank=True)

    class Meta:
        verbose_name = "CVE"
        verbose_name_plural = "CVEs"


class Product(models.Model):
	cve = models.ForeignKey(CVE, related_name='affected_products', on_delete=models.CASCADE)
	model = models.CharField(max_length=100, default="", blank=True, null=True)
	vendor = models.CharField(max_length=100, default="", blank=True, null=True)
	version = models.CharField(max_length=100, default="", blank=True, null=True)

	class Meta:
		verbose_name = "Product"
		verbose_name_plural = "Products"

class DataSources(models.Model):
	cve = models.ForeignKey(CVE, related_name='data_sources', on_delete=models.CASCADE)
	name = models.CharField(max_length=100, default="", blank=True, null=True)
	external_id = models.CharField(max_length=100, default="", blank=True, null=True)

	class Meta:
		verbose_name = "Data Source"
		verbose_name_plural = "Data Sources"

class Patch(models.Model):
	cve = models.ForeignKey(CVE, related_name='patches', on_delete=models.CASCADE)
	name = models.CharField(max_length=100, default="", blank=True, null=True)
	url = models.CharField(max_length=100, default="", blank=True, null=True)

	class Meta:
		verbose_name = "Patch"
		verbose_name_plural = "Patches"