from django.contrib import admin
from .models import CVE, Description, CVSSMetric, Weakness, WeaknessDescription, Configuration, Node, CPEMatch, Reference


class DescriptionInline(admin.TabularInline):
    model = Description


class CVSSMetricInline(admin.StackedInline):
    model = CVSSMetric


class WeaknessDescriptionInline(admin.TabularInline):
    model = WeaknessDescription


class WeaknessInline(admin.StackedInline):
    model = Weakness
    inlines = [WeaknessDescriptionInline]


class CPEMatchInline(admin.TabularInline):
    model = CPEMatch


class NodeInline(admin.StackedInline):
    model = Node
    inlines = [CPEMatchInline]


class ConfigurationInline(admin.StackedInline):
    model = Configuration
    inlines = [NodeInline]


class ReferenceInline(admin.TabularInline):
    model = Reference


@admin.register(CVE)
class CVEAdmin(admin.ModelAdmin):
    inlines = [DescriptionInline, CVSSMetricInline, WeaknessInline, ConfigurationInline, ReferenceInline]
    list_display = ['id', 'sourceIdentifier', 'published', 'lastModified', 'vulnStatus']
    search_fields = ['id', 'sourceIdentifier']


admin.site.register(Description)
admin.site.register(CVSSMetric)
admin.site.register(Weakness)
admin.site.register(WeaknessDescription)
admin.site.register(Configuration)
admin.site.register(Node)
admin.site.register(CPEMatch)
admin.site.register(Reference)

    

